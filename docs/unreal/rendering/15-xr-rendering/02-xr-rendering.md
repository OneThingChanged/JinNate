# XR 렌더링 기법

다중해상도 렌더링과 스테레오 렌더링 기법을 설명합니다.

---

## Foveated Rendering

인간의 시각 시스템을 활용하여 중심부만 고해상도로 렌더링합니다.

```
┌─────────────────────────────────────────────────────────────────┐
│                    Foveated Rendering                            │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  인간 시각:                                                     │
│  • 중심와 (Fovea): 선명한 시야, 약 2°                          │
│  • 주변 시야: 흐릿하지만 넓은 범위                             │
│                                                                 │
│  렌더링 영역:                                                   │
│  ┌─────────────────────────────────────────────────────────┐   │
│  │                                                         │   │
│  │    ┌─────────────────────────────────────────────┐     │   │
│  │    │           저해상도 (1/4x)                   │     │   │
│  │    │     ┌───────────────────────────────┐       │     │   │
│  │    │     │       중해상도 (1/2x)         │       │     │   │
│  │    │     │     ┌───────────────┐         │       │     │   │
│  │    │     │     │ 고해상도 (1x) │         │       │     │   │
│  │    │     │     │   (중심부)    │         │       │     │   │
│  │    │     │     └───────────────┘         │       │     │   │
│  │    │     └───────────────────────────────┘       │     │   │
│  │    └─────────────────────────────────────────────┘     │   │
│  │                                                         │   │
│  └─────────────────────────────────────────────────────────┘   │
│                                                                 │
│  성능 향상: GPU 부하 최대 25% 감소                              │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

### Fixed vs Eye-Tracked

| 방식 | 설명 | 장단점 |
|------|------|--------|
| **Fixed** | 화면 중앙 고정 | 간단, 시선 추적 불필요 |
| **Eye-Tracked** | 시선 따라 이동 | 최적, 하드웨어 필요 |

---

## 스테레오 렌더링

양쪽 눈에 대한 개별 이미지를 렌더링합니다.

### 렌더링 방식 비교

```
┌─────────────────────────────────────────────────────────────────┐
│                    스테레오 렌더링 방식                          │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  1. Multi-Camera (순차 렌더링):                                 │
│     ┌───────────────────────────────────────────────────────┐  │
│     │  Draw Left Eye → Draw Right Eye                       │  │
│     │  효율: 낮음 (2x Draw Call)                           │  │
│     └───────────────────────────────────────────────────────┘  │
│                                                                 │
│  2. Multi-Pass (공유 작업):                                     │
│     ┌───────────────────────────────────────────────────────┐  │
│     │  Shadow Maps (공유) → Left Eye → Right Eye           │  │
│     │  효율: 중간                                           │  │
│     └───────────────────────────────────────────────────────┘  │
│                                                                 │
│  3. Single-Pass (더블 와이드):                                  │
│     ┌───────────────────────────────────────────────────────┐  │
│     │  ┌─────────────┬─────────────┐                        │  │
│     │  │  Left Eye   │  Right Eye  │  ← 단일 렌더 타겟     │  │
│     │  └─────────────┴─────────────┘                        │  │
│     │  Viewport 전환으로 양안 렌더링                        │  │
│     │  효율: 높음                                           │  │
│     └───────────────────────────────────────────────────────┘  │
│                                                                 │
│  4. Stereo Instancing:                                          │
│     ┌───────────────────────────────────────────────────────┐  │
│     │  GPU Instancing으로 양안 동시 렌더링                  │  │
│     │  Draw Call 50% 감소                                  │  │
│     │  효율: 최고                                           │  │
│     └───────────────────────────────────────────────────────┘  │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

---

## Multi-View 렌더링

하드웨어 확장을 사용하여 단일 드로우 콜로 양안 렌더링합니다.

```cpp
// OpenGL ES Multi-View Extension
#extension GL_OVR_multiview2 : require

layout(num_views = 2) in;

void main()
{
    // gl_ViewID_OVR로 왼쪽(0)/오른쪽(1) 구분
    mat4 viewMatrix = ViewMatrices[gl_ViewID_OVR];
    gl_Position = ProjectionMatrix * viewMatrix * worldPosition;
}
```

```
┌─────────────────────────────────────────────────────────────────┐
│                    Multi-View 장점                               │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  CPU 오버헤드:                                                  │
│  • 기존: 2x Draw Call 제출                                     │
│  • Multi-View: 1x Draw Call 제출                               │
│  • CPU 제출 오버헤드 50% 감소                                  │
│                                                                 │
│  GPU 작업:                                                      │
│  • Vertex Shader는 양안에 대해 실행                            │
│  • Fragment Shader도 양안에 대해 실행                          │
│  • 공유 가능한 작업 (그림자 등)은 한 번만                      │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

---

## IPD (Inter-Pupillary Distance)

눈 간격에 따른 스테레오 카메라 설정입니다.

```
┌─────────────────────────────────────────────────────────────────┐
│                    IPD 설정                                      │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│       ◀───── IPD (평균 64mm) ─────▶                           │
│                                                                 │
│       ●                           ●                            │
│    왼쪽 눈                     오른쪽 눈                       │
│       │                           │                            │
│       │   왼쪽 뷰              │ 오른쪽 뷰                     │
│       │  ╱                     │   ╲                          │
│       │ ╱                       │    ╲                         │
│       │╱                        │     ╲                        │
│       ●────────────────────────●──────╲                        │
│                수렴점                                           │
│         (Convergence Point)                                     │
│                                                                 │
│  설정 요소:                                                     │
│  • IPD: 물리적 눈 간격 (사용자별 조절)                         │
│  • 수렴 거리: 시선이 만나는 거리                               │
│  • 월드 스케일: VR 내 1단위 = 실제 1m                          │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

---

## 다음 단계

[지연시간 최적화](03-latency-optimization.md)에서 Timewarp와 ASW를 알아봅니다.
