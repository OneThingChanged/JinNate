# GPU 아키텍처

GPU 구조, 렌더링 파이프라인, 벤더별 특징을 설명합니다.

---

## GPU 전체 구조

```
┌─────────────────────────────────────────────────────────────────┐
│                    GPU Architecture                             │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  ┌─────────────────────────────────────────────────────────┐   │
│  │                   GPC (Graphics Processing Cluster)      │   │
│  │  ┌─────────────────────────────────────────────────┐    │   │
│  │  │ SM │ SM │ SM │ SM │ SM │ SM │ SM │ SM │ SM │ SM │    │   │
│  │  └─────────────────────────────────────────────────┘    │   │
│  │  ┌─────────────────────────────────────────────────┐    │   │
│  │  │         Raster Engine  │  ROP  │  ROP  │  ROP   │    │   │
│  │  └─────────────────────────────────────────────────┘    │   │
│  └─────────────────────────────────────────────────────────┘   │
│                                                                 │
│  ┌─────────────────────────────────────────────────────────┐   │
│  │                   GPC 1  │  GPC 2  │  GPC 3  │  ...      │   │
│  └─────────────────────────────────────────────────────────┘   │
│                             │                                   │
│  ┌─────────────────────────────────────────────────────────┐   │
│  │                      L2 Cache (Shared)                   │   │
│  └─────────────────────────────────────────────────────────┘   │
│                             │                                   │
│  ┌─────────────────────────────────────────────────────────┐   │
│  │            Memory Controllers (GDDR6 / HBM)              │   │
│  └─────────────────────────────────────────────────────────┘   │
│                             │                                   │
│  ┌─────────────────────────────────────────────────────────┐   │
│  │                        VRAM                              │   │
│  └─────────────────────────────────────────────────────────┘   │
│                                                                 │
│  SM: Streaming Multiprocessor (NVIDIA)                         │
│  CU: Compute Unit (AMD)                                        │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

---

## SM (Streaming Multiprocessor)

```
┌─────────────────────────────────────────────────────────────────┐
│                    NVIDIA SM (Ampere 예시)                      │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  ┌─────────────────────────────────────────────────────────┐   │
│  │                       SM                                 │   │
│  │                                                         │   │
│  │  ┌───────────────────────────────────────────────────┐ │   │
│  │  │          Warp Scheduler  ×4                        │ │   │
│  │  │   (각 스케줄러가 독립적으로 Warp 발행)            │ │   │
│  │  └───────────────────────────────────────────────────┘ │   │
│  │                                                         │   │
│  │  ┌─────────────────────┐  ┌─────────────────────┐     │   │
│  │  │  Sub-core 0          │  │  Sub-core 1          │     │   │
│  │  │  ┌────────────────┐ │  │  ┌────────────────┐ │     │   │
│  │  │  │ FP32  ×16     │ │  │  │ FP32  ×16     │ │     │   │
│  │  │  │ INT32 ×16     │ │  │  │ INT32 ×16     │ │     │   │
│  │  │  │ FP64  ×8      │ │  │  │ FP64  ×8      │ │     │   │
│  │  │  │ Tensor Core×1  │ │  │  │ Tensor Core×1  │ │     │   │
│  │  │  │ LD/ST ×8      │ │  │  │ LD/ST ×8      │ │     │   │
│  │  │  │ SFU  ×4       │ │  │  │ SFU  ×4       │ │     │   │
│  │  │  └────────────────┘ │  │  └────────────────┘ │     │   │
│  │  │  Register File       │  │  Register File       │     │   │
│  │  └─────────────────────┘  └─────────────────────┘     │   │
│  │                                                         │   │
│  │  ┌───────────────────────────────────────────────────┐ │   │
│  │  │  Shared Memory / L1 Cache (128 KB 설정 가능)      │ │   │
│  │  └───────────────────────────────────────────────────┘ │   │
│  │                                                         │   │
│  │  ┌───────────────────────────────────────────────────┐ │   │
│  │  │  RT Core (Ray Tracing 전용)                        │ │   │
│  │  └───────────────────────────────────────────────────┘ │   │
│  │                                                         │   │
│  └─────────────────────────────────────────────────────────┘   │
│                                                                 │
│  FP32: 단정밀도 부동소수점                                     │
│  FP64: 배정밀도 부동소수점                                     │
│  SFU: Special Function Unit (sin, cos, exp 등)                │
│  LD/ST: Load/Store Unit                                        │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

---

## 그래픽 파이프라인 매핑

```
┌─────────────────────────────────────────────────────────────────┐
│                    Graphics Pipeline → GPU                      │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  Graphics Pipeline             GPU Hardware                     │
│  ─────────────────             ────────────                     │
│                                                                 │
│  ┌──────────────┐                                              │
│  │ Input Assembly│ ─────────► Polymorph Engine                 │
│  └──────┬───────┘              (Vertex Fetch)                   │
│         │                                                       │
│  ┌──────▼───────┐                                              │
│  │Vertex Shader │ ─────────► SM (프로그래머블)                 │
│  └──────┬───────┘                                              │
│         │                                                       │
│  ┌──────▼───────┐                                              │
│  │ Tessellation │ ─────────► SM + 고정 기능                    │
│  └──────┬───────┘                                              │
│         │                                                       │
│  ┌──────▼───────┐                                              │
│  │Geometry Shader│ ─────────► SM (프로그래머블)                │
│  └──────┬───────┘                                              │
│         │                                                       │
│  ┌──────▼───────┐                                              │
│  │ Rasterization│ ─────────► Raster Engine (고정 기능)        │
│  └──────┬───────┘              (삼각형 → 픽셀)                 │
│         │                                                       │
│  ┌──────▼───────┐                                              │
│  │ Pixel Shader │ ─────────► SM (프로그래머블)                 │
│  └──────┬───────┘                                              │
│         │                                                       │
│  ┌──────▼───────┐                                              │
│  │Output Merger │ ─────────► ROP (Render Output Unit)          │
│  └──────────────┘              (Depth Test, Blend, Write)      │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

---

## NVIDIA vs AMD

```
┌─────────────────────────────────────────────────────────────────┐
│                    벤더별 GPU 비교                               │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│               NVIDIA                    AMD                     │
│  ┌─────────────────────────┬─────────────────────────┐         │
│  │                         │                         │         │
│  │  SM (Streaming          │  CU (Compute Unit)     │         │
│  │   Multiprocessor)       │                         │         │
│  │                         │                         │         │
│  │  Warp = 32 threads     │  Wavefront = 64 threads│         │
│  │                         │  (RDNA: 32도 지원)     │         │
│  │                         │                         │         │
│  │  RT Core (BVH 전용)    │  RA (Ray Accelerator)  │         │
│  │                         │                         │         │
│  │  Tensor Core (AI)      │  Matrix Core           │         │
│  │                         │                         │         │
│  │  CUDA                   │  HIP / OpenCL          │         │
│  │                         │                         │         │
│  │  DLSS (AI 업스케일)    │  FSR (공간 업스케일)   │         │
│  │                         │                         │         │
│  └─────────────────────────┴─────────────────────────┘         │
│                                                                 │
│  아키텍처 세대:                                                 │
│  NVIDIA: Kepler → Maxwell → Pascal → Turing → Ampere → Ada    │
│  AMD: GCN → RDNA → RDNA 2 → RDNA 3                            │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

---

## GPU 메모리 구조

```
┌─────────────────────────────────────────────────────────────────┐
│                    GPU Memory Hierarchy                         │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  속도 (느림 → 빠름):                                           │
│                                                                 │
│  ┌───────────────────────────────────────────────────────────┐ │
│  │ Global Memory (VRAM)                                      │ │
│  │ • 수 GB ~ 수십 GB                                        │ │
│  │ • ~1000 cycles 접근 지연                                 │ │
│  │ • 텍스처, 버퍼, 프레임버퍼                               │ │
│  └───────────────────────────────────────────────────────────┘ │
│                          ↑                                      │
│  ┌───────────────────────────────────────────────────────────┐ │
│  │ L2 Cache                                                  │ │
│  │ • 수 MB                                                   │ │
│  │ • ~200 cycles                                            │ │
│  │ • 전체 GPU 공유                                          │ │
│  └───────────────────────────────────────────────────────────┘ │
│                          ↑                                      │
│  ┌───────────────────────────────────────────────────────────┐ │
│  │ L1 Cache / Shared Memory                                  │ │
│  │ • SM당 수십~수백 KB                                      │ │
│  │ • ~20 cycles                                             │ │
│  │ • 프로그래머가 제어 가능 (Shared Memory)                 │ │
│  └───────────────────────────────────────────────────────────┘ │
│                          ↑                                      │
│  ┌───────────────────────────────────────────────────────────┐ │
│  │ Registers                                                 │ │
│  │ • SM당 수만~수십만 개                                    │ │
│  │ • 1 cycle                                                │ │
│  │ • 스레드별 할당                                          │ │
│  └───────────────────────────────────────────────────────────┘ │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

---

## GPU 사양 비교

| 사양 | RTX 4090 | RX 7900 XTX |
|------|----------|-------------|
| SM/CU 수 | 128 SM | 96 CU |
| CUDA/SP 코어 | 16,384 | 6,144 |
| 클럭 | 2.52 GHz | 2.5 GHz |
| VRAM | 24 GB GDDR6X | 24 GB GDDR6 |
| 대역폭 | 1 TB/s | 960 GB/s |
| TDP | 450W | 355W |

---

## 다음 단계

[SIMT 실행 모델](05-simt-execution.md)에서 GPU 실행 방식을 알아봅니다.

