# Ch.06 UE5 신기능

UE5의 혁신적인 렌더링 기술들을 심층 분석합니다.

---

## 개요

Unreal Engine 5는 2022년 정식 출시와 함께 게임 그래픽의 새로운 기준을 제시했습니다. 특히 **Nanite**와 **Lumen**은 실시간 렌더링의 패러다임을 바꾼 핵심 기술입니다.

```
┌─────────────────────────────────────────────────────────────────┐
│                    UE5 렌더링 혁신                               │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  ┌─────────────────────────────────────────────────────────┐   │
│  │                    Nanite                                │   │
│  │  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐      │   │
│  │  │ 가상화      │  │ GPU-Driven  │  │ 소프트웨어   │      │   │
│  │  │ 지오메트리   │→│ 렌더링      │→│ 래스터라이저 │      │   │
│  │  └─────────────┘  └─────────────┘  └─────────────┘      │   │
│  └─────────────────────────────────────────────────────────┘   │
│                              │                                  │
│                              ▼                                  │
│  ┌─────────────────────────────────────────────────────────┐   │
│  │                    Lumen                                 │   │
│  │  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐      │   │
│  │  │ 소프트웨어   │  │ 하드웨어    │  │ 하이브리드   │      │   │
│  │  │ 레이트레이싱 │  │ 레이트레이싱 │  │ GI          │      │   │
│  │  └─────────────┘  └─────────────┘  └─────────────┘      │   │
│  └─────────────────────────────────────────────────────────┘   │
│                              │                                  │
│                              ▼                                  │
│  ┌─────────────────────────────────────────────────────────┐   │
│  │              Virtual Shadow Maps                         │   │
│  │  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐      │   │
│  │  │ 클립맵      │  │ 가상 텍스처  │  │ 캐시 시스템  │      │   │
│  │  │ 구조        │→│ 기반        │→│             │      │   │
│  │  └─────────────┘  └─────────────┘  └─────────────┘      │   │
│  └─────────────────────────────────────────────────────────┘   │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

---

## 목차

| 문서 | 주제 | 핵심 내용 |
|------|------|----------|
| [01](01-ue5-overview.md) | UE5 렌더링 개요 | 아키텍처 변화, 새로운 파이프라인 |
| [02](02-nanite.md) | Nanite | 가상화 지오메트리, GPU 렌더링 |
| [03](03-lumen.md) | Lumen | 글로벌 일루미네이션, 반사 |
| [04](04-virtual-shadow-maps.md) | Virtual Shadow Maps | 고해상도 그림자, 클립맵 |
| [05](05-other-features.md) | 기타 신기능 | TSR, Substrate, World Partition |

---

## UE5 렌더링 아키텍처

### 핵심 변화

```cpp
// UE4 vs UE5 렌더링 패러다임 비교
// UE4: 전통적 메시 기반 렌더링
class FStaticMeshSceneProxy : public FPrimitiveSceneProxy
{
    // LOD 기반 메시 선택
    void GetDynamicMeshElements(...)
    {
        int32 LODIndex = ComputeLODLevel(View);
        DrawStaticMesh(LODIndex);
    }
};

// UE5: Nanite 가상화 지오메트리
class FNaniteSceneProxy : public FPrimitiveSceneProxy
{
    // GPU 주도 클러스터 선택
    // LOD 개념 없음 - 연속적 디테일
    FNaniteStreamingData StreamingData;

    void GetNaniteResourceInfo(...)
    {
        // GPU가 직접 가시성 결정
        // 픽셀 수준 LOD 선택
    }
};
```

### 렌더링 파이프라인 변화

| 단계 | UE4 | UE5 |
|------|-----|-----|
| 지오메트리 처리 | CPU LOD 선택 | Nanite GPU 클러스터링 |
| 그림자 | Cascaded Shadow Maps | Virtual Shadow Maps |
| 간접광 | 베이크 라이트맵 / SSGI | Lumen 실시간 GI |
| 반사 | SSR / 큐브맵 | Lumen 반사 |
| 업스케일링 | TAA | TSR (Temporal Super Resolution) |

---

## 시스템 요구사항

### Nanite
- DirectX 12 또는 Vulkan
- Shader Model 6.0 이상
- 최소 8GB VRAM (권장 12GB+)
- Mesh Shader 지원 (선택적)

### Lumen
- 소프트웨어 레이트레이싱: DX11/12
- 하드웨어 레이트레이싱: RTX 20 시리즈 이상
- 최소 6GB VRAM (권장 10GB+)

### Virtual Shadow Maps
- Nanite와 동일한 요구사항
- 추가 VRAM 사용 (2-4GB)

---

## 성능 특성

```
┌────────────────────────────────────────────────────────────────┐
│                    성능 프로파일                                │
├────────────────────────────────────────────────────────────────┤
│                                                                │
│  GPU 사용률 (%)                                                │
│  100 ┤                                                         │
│      │    ┌───┐                                                │
│   80 ┤    │   │ ┌───┐                                          │
│      │    │   │ │   │ ┌───┐                                    │
│   60 ┤    │   │ │   │ │   │ ┌───┐                              │
│      │    │   │ │   │ │   │ │   │                              │
│   40 ┤    │   │ │   │ │   │ │   │                              │
│      │    │   │ │   │ │   │ │   │                              │
│   20 ┤    │   │ │   │ │   │ │   │                              │
│      │    │   │ │   │ │   │ │   │                              │
│    0 ┼────┴───┴─┴───┴─┴───┴─┴───┴──────────────────────────    │
│          Nanite  Lumen   VSM   기타                            │
│                                                                │
│  일반적인 UE5 씬에서의 GPU 시간 분포                            │
│  - Nanite: 20-30%                                              │
│  - Lumen: 25-40%                                               │
│  - Virtual Shadow Maps: 10-20%                                 │
│  - 기타 (포스트프로세싱, UI 등): 20-30%                         │
│                                                                │
└────────────────────────────────────────────────────────────────┘
```

---

## 학습 순서

1. **UE5 렌더링 개요** - 전체적인 아키텍처 변화 이해
2. **Nanite** - 지오메트리 혁신의 핵심
3. **Lumen** - 실시간 글로벌 일루미네이션
4. **Virtual Shadow Maps** - Nanite와 연동되는 그림자 시스템
5. **기타 신기능** - TSR, Substrate 등 보조 기술

---

## 참고 자료

- [UE5 공식 문서](https://docs.unrealengine.com/5.0/)
- [Nanite 기술 프레젠테이션 (SIGGRAPH 2021)](https://advances.realtimerendering.com/s2021/)
- [Lumen 기술 문서](https://docs.unrealengine.com/5.0/en-US/lumen-global-illumination-and-reflections-in-unreal-engine/)
- [원문 시리즈 (중국어)](https://www.cnblogs.com/timlly/p/13512787.html)
