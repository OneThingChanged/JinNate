# 현대 그래픽 API 개요

DirectX 12, Vulkan, Metal의 설계 철학과 핵심 특징을 설명합니다.

---

## 현대 API의 등장 배경

### 레거시 API의 한계

```
┌─────────────────────────────────────────────────────────────────┐
│                    레거시 API 문제점                             │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  1. 드라이버 오버헤드                                           │
│     ┌─────────────────────────────────────────────────────┐    │
│     │  App → [Heavy Driver Layer] → GPU                   │    │
│     │           ↑                                         │    │
│     │     • 상태 검증                                     │    │
│     │     • 리소스 추적                                   │    │
│     │     • 암시적 동기화                                 │    │
│     │     • 셰이더 컴파일                                 │    │
│     └─────────────────────────────────────────────────────┘    │
│                                                                 │
│  2. CPU 병목                                                    │
│     • Draw Call당 수천 사이클                                  │
│     • 단일 스레드 커맨드 빌드                                  │
│     • 복잡한 장면에서 CPU 한계                                 │
│                                                                 │
│  3. 예측 불가능한 성능                                          │
│     • 드라이버 휴리스틱에 의존                                 │
│     • 프레임 스파이크                                          │
│     • 디버깅 어려움                                            │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

### 현대 API의 설계 원칙

```
┌─────────────────────────────────────────────────────────────────┐
│                    현대 API 설계 원칙                            │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  "애플리케이션 개발자가 드라이버보다 리소스의 중요도를          │
│   더 잘 알고 있다"                                              │
│                                                                 │
│  1. 명시적 제어                                                 │
│     • 리소스 생명주기 직접 관리                                │
│     • 메모리 할당/해제 명시적 수행                             │
│     • 동기화 지점 명시적 지정                                  │
│                                                                 │
│  2. 낮은 오버헤드                                               │
│     • 드라이버 검증 최소화                                     │
│     • 사전 컴파일된 상태 객체                                  │
│     • 최소한의 런타임 처리                                     │
│                                                                 │
│  3. 멀티스레드 친화적                                           │
│     • 병렬 커맨드 버퍼 빌드                                    │
│     • 스레드별 독립적 리소스                                   │
│     • Lock-free 설계                                           │
│                                                                 │
│  4. 예측 가능한 성능                                            │
│     • 일관된 프레임 타임                                       │
│     • 명확한 성능 특성                                         │
│     • 디버깅 용이                                              │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

---

## API별 특성

### DirectX 12

```
┌─────────────────────────────────────────────────────────────────┐
│                    DirectX 12                                    │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  플랫폼: Windows 10+, Xbox                                      │
│  출시: 2015                                                     │
│                                                                 │
│  특징:                                                          │
│  • Microsoft 생태계 최적화                                     │
│  • DirectX Raytracing (DXR) 지원                               │
│  • PIX 디버깅 도구                                             │
│  • HLSL 셰이더 언어                                            │
│                                                                 │
│  핵심 구성요소:                                                 │
│  • ID3D12Device                                                │
│  • ID3D12CommandQueue                                          │
│  • ID3D12GraphicsCommandList                                   │
│  • ID3D12PipelineState                                         │
│  • ID3D12RootSignature                                         │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

### Vulkan

```
┌─────────────────────────────────────────────────────────────────┐
│                    Vulkan                                        │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  플랫폼: Windows, Linux, Android, macOS (MoltenVK)              │
│  출시: 2016                                                     │
│                                                                 │
│  특징:                                                          │
│  • 크로스 플랫폼                                               │
│  • Khronos Group 표준                                          │
│  • 매우 명시적인 API                                           │
│  • SPIR-V 셰이더                                               │
│  • Ray Tracing 확장                                            │
│                                                                 │
│  핵심 구성요소:                                                 │
│  • VkInstance                                                  │
│  • VkDevice                                                    │
│  • VkQueue                                                     │
│  • VkCommandBuffer                                             │
│  • VkPipeline                                                  │
│  • VkRenderPass                                                │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

### Metal

```
┌─────────────────────────────────────────────────────────────────┐
│                    Metal                                         │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  플랫폼: iOS, macOS, tvOS                                       │
│  출시: 2014                                                     │
│                                                                 │
│  특징:                                                          │
│  • Apple 하드웨어 최적화                                       │
│  • 상대적으로 간결한 API                                       │
│  • Metal Shading Language                                      │
│  • 통합 메모리 아키텍처 활용                                   │
│  • Ray Tracing 지원 (Metal 3)                                  │
│                                                                 │
│  핵심 구성요소:                                                 │
│  • MTLDevice                                                   │
│  • MTLCommandQueue                                             │
│  • MTLCommandBuffer                                            │
│  • MTLRenderPipelineState                                      │
│  • MTLRenderPassDescriptor                                     │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

---

## API 선택 가이드

```
┌─────────────────────────────────────────────────────────────────┐
│                    API 선택 기준                                 │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  Windows/Xbox 전용:                                             │
│  └─▶ DirectX 12                                                │
│      • 최고의 Windows 지원                                     │
│      • Xbox 동시 개발 용이                                     │
│                                                                 │
│  크로스 플랫폼:                                                 │
│  └─▶ Vulkan                                                    │
│      • Windows + Linux + Android                               │
│      • macOS는 MoltenVK 통해 지원                              │
│                                                                 │
│  Apple 플랫폼:                                                  │
│  └─▶ Metal                                                     │
│      • iOS/macOS 최적 성능                                     │
│      • Apple Silicon 최적화                                    │
│                                                                 │
│  UE에서는:                                                      │
│  └─▶ RHI 추상화를 통해 모든 API 지원                          │
│      • 플랫폼별 자동 선택                                      │
│      • 통일된 인터페이스                                       │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

---

## 성능 향상 효과

### D3D11 vs D3D12 비교

```
┌─────────────────────────────────────────────────────────────────┐
│                    성능 비교 예시                                │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  테스트 환경: 복잡한 장면, 많은 Draw Call                       │
│                                                                 │
│                    D3D11        D3D12       개선율              │
│  ─────────────────────────────────────────────────────────────│
│  프레임 타임       16.0ms       11.0ms      ~31% 감소          │
│  GPU 시간         10.0ms        5.0ms       ~50% 감소          │
│  Draw Call 비용    High         Low         ~90% 감소          │
│  CPU 사용률       Single-core   Multi-core  확장 가능          │
│                                                                 │
│  주의: 단순한 장면에서는 차이가 적을 수 있음                    │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

---

## 학습 곡선

```
┌─────────────────────────────────────────────────────────────────┐
│                    API 복잡도                                    │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  복잡도 ↑                                                       │
│    │                                                            │
│    │  ┌─────────┐                                              │
│    │  │ Vulkan  │  가장 명시적, 가장 verbose                   │
│    │  └─────────┘                                              │
│    │        ┌─────────┐                                        │
│    │        │  D3D12  │  명시적이나 일부 추상화                │
│    │        └─────────┘                                        │
│    │              ┌─────────┐                                  │
│    │              │  Metal  │  상대적으로 간결                 │
│    │              └─────────┘                                  │
│    │                    ┌─────────┐                            │
│    │                    │  D3D11  │  암시적, 사용 용이         │
│    │                    └─────────┘                            │
│    └────────────────────────────────────────▶ 사용 용이성      │
│                                                                 │
│  Vulkan 삼각형 하나 그리기: ~1000줄                            │
│  D3D11 삼각형 하나 그리기: ~200줄                              │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

---

## 다음 단계

[Device와 Context](02-device-context.md)에서 장치 초기화와 Swapchain을 알아봅니다.
